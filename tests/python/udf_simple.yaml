schema: https://stepflow.org/schemas/v1/flow.json
input_schema:
  type: object
  properties:
    x:
      type: number
    y:
      type: number
output_schema:
  type: object
  properties:
    custom_calculation:
      type: number
    product:
      type: number
    sum:
      type: number
steps:
- id: create_addition_blob
  component: /builtin/put_blob
  input:
    data:
      input_schema:
        type: object
        properties:
          x:
            type: number
          y:
            type: number
        required:
        - x
        - y
      code: input['x'] + input['y']
    blob_type: data
- id: create_multiplication_blob
  component: /builtin/put_blob
  input:
    data:
      input_schema:
        type: object
        properties:
          x:
            type: number
          y:
            type: number
        required:
        - x
        - y
      code: input['x'] * input['y']
    blob_type: data
- id: create_complex_calculation_blob
  component: /builtin/put_blob
  input:
    data:
      input_schema:
        type: object
        properties:
          sum:
            type: number
          product:
            type: number
        required:
        - sum
        - product
      code: math.sqrt(input['sum'] ** 2 + input['product'] ** 2)
    blob_type: data
- id: simple_addition
  component: /python/udf
  input:
    blob_id:
      $step: create_addition_blob
      path: blob_id
    input:
      x:
        $input: x
      y:
        $input: y
- id: simple_multiplication
  component: /python/udf
  input:
    blob_id:
      $step: create_multiplication_blob
      path: blob_id
    input:
      x:
        $input: x
      y:
        $input: y
- id: complex_calculation
  component: /python/udf
  input:
    blob_id:
      $step: create_complex_calculation_blob
      path: blob_id
    input:
      sum:
        $step: simple_addition
      product:
        $step: simple_multiplication
output:
  sum:
    $step: simple_addition
  product:
    $step: simple_multiplication
  custom_calculation:
    $step: complex_calculation
test:
  cases:
  - name: calculate with x=3, y=4
    input:
      x: 3
      y: 4
    output:
      outcome: success
      result:
        custom_calculation: 13.892443989449804
        product: 12
        sum: 7
  - name: calculate with x=5, y=12
    input:
      x: 5
      y: 12
    output:
      outcome: success
      result:
        custom_calculation: 62.36184731067546
        product: 60
        sum: 17
