schema: https://stepflow.org/schemas/v1/flow.json
name: must_execute and skip_if interaction tests
description: Test the interaction between must_execute and skip_if fields
inputSchema:
  type: object
  properties:
    shouldSkip:
      type: boolean
    value:
      type: string
outputSchema:
  type: object
  properties:
    result:
      type: string
steps:
- id: input_step
  component: /mock/one_output
  input:
    input:
      $input: value
- id: must_exec_conditional
  component: /mock/error
  mustExecute: true
  skipIf: { $input: shouldSkip }
  input:
    mode: error
- id: output_step
  component: /mock/one_output
  input:
    input:
      $step: input_step
      path: output
output:
  $step: output_step
  path: output
test:
  cases:
  - name: must_execute with skipIf true - step skipped, workflow succeeds
    description: When skipIf is true, must_execute step should be skipped and not
      cause failure
    input:
      shouldSkip: true
      value: a
    output:
      outcome: success
      result: b
  - name: must_execute with skipIf false - step executes and fails
    description: When skipIf is false, must_execute step executes and causes workflow
      failure
    input:
      shouldSkip: false
      value: a
    output:
      outcome: failed
      error:
        code: 8
        message: error
  - name: must_execute input dependency required
    description: Input step must execute to provide data for must_execute step
    input:
      shouldSkip: true
      value: b
    output:
      outcome: success
      result: b
