---
source: crates/stepflow-cli/tests/commands/test_list_components.rs
info:
  program: stepflow
  args:
    - "--log-file=/dev/null"
    - "--omit-stack-trace"
    - "--log-level=error"
    - list-components
    - "--config=tests/stepflow-config.yml"
    - "--format=yaml"
  env:
    STEPFLOW_LOG_DESTINATION: ""
    STEPFLOW_LOG_FILE: ""
    STEPFLOW_LOG_FORMAT: ""
    STEPFLOW_LOG_LEVEL: ""
    STEPFLOW_OTHER_LOG_LEVEL: ""
    STEPFLOW_OTLP_ENDPOINT: ""
    STEPFLOW_TRACE_ENABLED: ""
---
success: true
exit_code: 0
----- stdout -----
components:
- component: /create_messages
  description: Create a chat message list from system instructions and user prompt
  input_schema:
    $schema: https://json-schema.org/draft/2020-12/schema
    title: CreateMessagesInput
    type: object
    required:
    - user_prompt
    properties:
      system_instructions:
        type:
        - string
        - 'null'
        description: The system instructions to include in the message list.
      user_prompt:
        type: string
        description: The user prompt to include in the message list.
  output_schema:
    $schema: https://json-schema.org/draft/2020-12/schema
    title: CreateMessagesOutput
    type: object
    required:
    - messages
    properties:
      messages:
        type: array
        items:
          $ref: '#/$defs/ChatMessage'
  plugin: builtin
  routes:
  - pathPattern: /builtin/{*component}
    resolvedPath: /builtin/create_messages
    conditions: []
    isConditional: false
- component: /eval
  description: Execute a nested workflow with given input and return the result
  input_schema:
    $schema: https://json-schema.org/draft/2020-12/schema
    title: EvalInput
    type: object
    description: Input for the eval component
    required:
    - flow_id
    - input
    properties:
      flow_id:
        $ref: '#/$defs/BlobId'
        description: The ID of the workflow to execute (blob ID)
      input:
        $ref: '#/$defs/Value'
        description: The input to pass to the workflow
  output_schema:
    $schema: https://json-schema.org/draft/2020-12/schema
    title: EvalOutput
    type: object
    description: |-
      Output from the eval component

      The output is simply the result of the nested workflow execution
    required:
    - result
    - run_id
    properties:
      result:
        $ref: '#/$defs/FlowResult'
        description: The result from executing the nested workflow
      run_id:
        type: string
        description: The run ID of the nested workflow
  plugin: builtin
  routes:
  - pathPattern: /builtin/{*component}
    resolvedPath: /builtin/eval
    conditions: []
    isConditional: false
- component: /get_blob
  description: Retrieve JSON data from a blob using its ID
  input_schema:
    $schema: https://json-schema.org/draft/2020-12/schema
    title: GetBlobInput
    type: object
    description: Input for the get_blob component
    required:
    - blob_id
    properties:
      blob_id:
        type: string
        description: The blob ID to retrieve
  output_schema:
    $schema: https://json-schema.org/draft/2020-12/schema
    title: GetBlobOutput
    type: object
    description: Output from the get_blob component
    required:
    - data
    properties:
      data:
        description: The JSON data stored in the blob
  plugin: builtin
  routes:
  - pathPattern: /builtin/{*component}
    resolvedPath: /builtin/get_blob
    conditions: []
    isConditional: false
- component: /iterate
  description: Iteratively apply a workflow until it returns a result instead of next
  input_schema:
    $schema: https://json-schema.org/draft/2020-12/schema
    title: IterateInput
    type: object
    description: Input for the iterate component
    required:
    - flow
    - initial_input
    properties:
      flow:
        $ref: '#/$defs/Flow'
        description: 'The workflow to iterate. Must return either {"result": value} or {"next": value}'
      initial_input:
        $ref: '#/$defs/Value'
        description: The initial input to pass to the workflow
      max_iterations:
        type: integer
        format: int32
        description: 'Maximum number of iterations to prevent infinite loops (default: 1000)'
        minimum: 0
  output_schema:
    $schema: https://json-schema.org/draft/2020-12/schema
    title: IterateOutput
    type: object
    description: Output from the iterate component
    required:
    - result
    - iterations
    - terminated
    properties:
      result:
        $ref: '#/$defs/Value'
        description: The final result value
      iterations:
        type: integer
        format: int32
        description: The number of iterations performed
        minimum: 0
      terminated:
        type: boolean
        description: Whether the iteration was terminated by max_iterations
  plugin: builtin
  routes:
  - pathPattern: /builtin/{*component}
    resolvedPath: /builtin/iterate
    conditions: []
    isConditional: false
- component: /load_file
  description: Load and parse a file (JSON, YAML, or text) from the filesystem
  input_schema:
    $schema: https://json-schema.org/draft/2020-12/schema
    title: LoadFileInput
    type: object
    required:
    - path
    properties:
      path:
        type: string
        description: Path to the file to load
      format:
        oneOf:
        - type: 'null'
        - $ref: '#/$defs/FileFormat'
          description: Format of the file (json, yaml, text). If not specified, inferred from extension
  output_schema:
    $schema: https://json-schema.org/draft/2020-12/schema
    title: LoadFileOutput
    type: object
    required:
    - data
    - metadata
    properties:
      data:
        description: The loaded data (parsed JSON/YAML or raw text)
      metadata:
        $ref: '#/$defs/FileMetadata'
        description: Metadata about the loaded file
  plugin: builtin
  routes:
  - pathPattern: /builtin/{*component}
    resolvedPath: /builtin/load_file
    conditions: []
    isConditional: false
- component: /map
  description: Apply a workflow to each item in a list and collect the results
  input_schema:
    $schema: https://json-schema.org/draft/2020-12/schema
    title: MapInput
    type: object
    description: Input for the map component
    required:
    - workflow
    - items
    properties:
      workflow:
        $ref: '#/$defs/Flow'
        description: The workflow to apply to each item
      items:
        type: array
        items:
          $ref: '#/$defs/Value'
        description: The list of items to process
      max_concurrency:
        type:
        - integer
        - 'null'
        description: Maximum number of concurrent executions (optional, defaults to number of items)
        minimum: 0
  output_schema:
    $schema: https://json-schema.org/draft/2020-12/schema
    title: MapOutput
    type: object
    description: Output from the map component
    required:
    - results
    - successful
    - failed
    properties:
      results:
        type: array
        items:
          $ref: '#/$defs/FlowResult'
        description: The results from processing each item
      successful:
        type: integer
        format: int32
        description: Summary statistics
        minimum: 0
      failed:
        type: integer
        format: int32
        minimum: 0
  plugin: builtin
  routes:
  - pathPattern: /builtin/{*component}
    resolvedPath: /builtin/map
    conditions: []
    isConditional: false
- component: /openai
  description: Send messages to OpenAI's chat completion API and get a response
  input_schema:
    $schema: https://json-schema.org/draft/2020-12/schema
    title: OpenAIInput
    type: object
    description: Input for the OpenAI component
    required:
    - messages
    properties:
      messages:
        type: array
        items:
          $ref: '#/$defs/ChatMessage'
        description: The messages to send to the API
      max_tokens:
        type:
        - integer
        - 'null'
        format: int32
        description: Max tokens to generate (optional)
        minimum: 0
      temperature:
        type:
        - number
        - 'null'
        format: float
        description: Temperature setting (optional)
      api_key:
        type:
        - string
        - 'null'
        description: API key override (optional - uses environment variable if not provided)
  output_schema:
    $schema: https://json-schema.org/draft/2020-12/schema
    title: OpenAIOutput
    type: object
    description: Output from the OpenAI component
    required:
    - response
    properties:
      response:
        type: string
        description: The generated response text
  plugin: builtin
  routes:
  - pathPattern: /builtin/{*component}
    resolvedPath: /builtin/openai
    conditions: []
    isConditional: false
- component: /put_blob
  description: Store JSON data as a blob and return its content-addressable ID
  input_schema:
    $schema: https://json-schema.org/draft/2020-12/schema
    title: PutBlobInput
    type: object
    description: Input for the put_blob component
    required:
    - data
    - blob_type
    properties:
      data:
        description: The JSON data to store as a blob
      blob_type:
        $ref: '#/$defs/BlobType'
        description: The type of blob to store
  output_schema:
    $schema: https://json-schema.org/draft/2020-12/schema
    title: PutBlobOutput
    type: object
    description: Output from the put_blob component
    required:
    - blob_id
    properties:
      blob_id:
        type: string
        description: The blob ID for the stored data
  plugin: builtin
  routes:
  - pathPattern: /builtin/{*component}
    resolvedPath: /builtin/put_blob
    conditions: []
    isConditional: false


----- stderr -----
